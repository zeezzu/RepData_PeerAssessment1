{
    "collab_server" : "",
    "contents" : "# Reproducible Research: Peer Assessment 1\n\n\n## Loading and preprocessing the data\nunzip(zipfile=\"activity.zip\")\ndata <- read.csv(\"activity.csv\")\n\n\n## What is mean total number of steps taken per day?\nlibrary(ggplot2)\ntotal.steps <- tapply(data$steps, data$date, FUN=sum, na.rm=TRUE)\nqplot(total.steps, binwidth=1000, xlab=\"total number of steps taken each day\")\nmean(total.steps, na.rm=TRUE)\nmedian(total.steps, na.rm=TRUE)\n\n\n## What is the average daily activity pattern?\nlibrary(ggplot2)\naverages <- aggregate(x=list(steps=data$steps), by=list(interval=data$interval),\n                      FUN=mean, na.rm=TRUE)\nggplot(data=averages, aes(x=interval, y=steps)) +\n        geom_line() +\n        xlab(\"5-minute interval\") +\n        ylab(\"average number of steps taken\")\naverages[which.max(averages$steps),]\n\n\n## Imputing missing values\nmissing <- is.na(data$steps)\n# How many missing\ntable(missing)\n\n# Replace each missing value with the mean value of its 5-minute interval\nfill.value <- function(steps, interval) {\n        filled <- NA\n        if (!is.na(steps))\n                filled <- c(steps)\n        else\n                filled <- (averages[averages$interval==interval, \"steps\"])\n        return(filled)\n}\nfilled.data <- data\nfilled.data$steps <- mapply(fill.value, filled.data$steps, filled.data$interval)\ntotal.steps <- tapply(filled.data$steps, filled.data$date, FUN=sum)\nqplot(total.steps, binwidth=1000, xlab=\"total number of steps taken each day\")\nmean(total.steps)\nmedian(total.steps)\n\n\n## Are there differences in activity patterns between weekdays and weekends?\nweekday.or.weekend <- function(date) {\n        day <- weekdays(date)\n        if (day %in% c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\"))\n                return(\"weekday\")\n        else if (day %in% c(\"Saturday\", \"Sunday\"))\n                return(\"weekend\")\n        else\n                stop(\"invalid date\")\n}\nfilled.data$date <- as.Date(filled.data$date)\nfilled.data$day <- sapply(filled.data$date, FUN=weekday.or.weekend)\naverages <- aggregate(steps ~ interval + day, data=filled.data, mean)\nggplot(averages, aes(interval, steps)) + geom_line() + facet_grid(day ~ .) +\n        xlab(\"5-minute interval\") + ylab(\"Number of steps\")\n",
    "created" : 1498601357271.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1019456359",
    "id" : "BEDC5113",
    "lastKnownWriteTime" : 1498602402,
    "last_content_update" : 1498602402,
    "path" : "~/Documents/GitHub/RepData_PeerAssessment1/PA1_template.md",
    "project_path" : "PA1_template.md",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "markdown"
}